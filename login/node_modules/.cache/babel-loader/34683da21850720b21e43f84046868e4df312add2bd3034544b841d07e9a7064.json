{"ast":null,"code":"import report from \"./report.vue\";\nexport default {\n  name: 'manage',\n  data() {\n    return {\n      station: {},\n      charge_array: [],\n      wait_array: []\n    };\n  },\n  // mounted(){\n  //   this.autogetdata();\n  //   this.timer = setInterval(this.autogetdata,30000)\n  // },\n  methods: {\n    autogetdata() {\n      var token = localStorage.getItem('token');\n      var send_data = {\n        \"token\": '1',\n        \"query_info\": {\n          \"msg\": \"\"\n        }\n      };\n      console.log(\"获取数据\");\n      console.log(\"我被执行了\");\n      this.axios({\n        method: 'GET',\n        url: `https://mock.apifox.cn/m1/2726825-0-default/admin/index/manage`,\n        // headers:{\n        //   'Content-type': 'application/json; charset=UTF-8'\n        // },\n        data: JSON.stringify(send_data)\n      }).then(response => {\n        console.log(\"@autogetdata\");\n        console.log(response);\n        if (response.data.code != 0) {\n          this.station = response.data.data.station;\n          this.charge_array = response.data.data.station.charge_array;\n          this.wait_array = response.data.data.station.wait_array;\n          console.log(this.charge_array);\n        } else {\n          this.info = response.data.msg;\n        }\n      }).catch(error => {\n        alert('manage出错了');\n        // this.$router.push('/admin/manage')\n      });\n    },\n\n    jump(id) {\n      // console.log(\"点击\"+id)\n      this.$router.replace({\n        path: '/admin/index/report',\n        query: {\n          \"stationid\": id\n        }\n      });\n    },\n    changestate(index) {\n      var send_data = {\n        \"token\": localStorage.getItem(\"token\"),\n        \"switch_array\": [this.charge_array[index].id]\n      };\n      this.axios({\n        method: 'POST',\n        url: `https://mock.apifox.cn/m1/2726825-0-default/admin/index/manage`,\n        headers: {\n          'Content-type': 'application/json; charset=UTF-8'\n        },\n        data: JSON.stringify(send_data)\n      }).then(response => {\n        console.log(\"@changestate\" + response);\n        if (response.data.code != 0) {\n          // console.log(response)\n          // this.$router.push('/admin/manage')\n          this.charge_array[index].state = !this.charge_array[index].state;\n        } else {\n          this.info = response.data.msg;\n        }\n      }).catch(error => {\n        alert('出错了');\n        // this.$router.push('/admin/manage')\n      });\n    },\n\n    jumpcharge(id) {\n      this.$router.replace({\n        path: '/admin/manage/charge',\n        query: {\n          \"stationid\": id\n        }\n      });\n    },\n    goback() {\n      this.$router.go(-1);\n    }\n  },\n  beforeDestroy() {\n    clearInterval(this.timer);\n    this.timer = null;\n  },\n  beforeRouteLeave(to, from, next) {\n    console.log(\"离开当前页面\");\n    clearInterval(this.timer);\n    next();\n    // this.timer = null\n  },\n\n  beforeRouteEnter(to, from, next) {\n    next(vm => {\n      console.log(\"enter\");\n      vm.autogetdata();\n      vm.timer = setInterval(vm.autogetdata, 30000);\n    });\n  }\n};","map":{"version":3,"names":["report","name","data","station","charge_array","wait_array","methods","autogetdata","token","localStorage","getItem","send_data","console","log","axios","method","url","JSON","stringify","then","response","code","info","msg","catch","error","alert","jump","id","$router","replace","path","query","changestate","index","headers","state","jumpcharge","goback","go","beforeDestroy","clearInterval","timer","beforeRouteLeave","to","from","next","beforeRouteEnter","vm","setInterval"],"sources":["src/components/admin/manage.vue"],"sourcesContent":["<template>\r\n  <div>\r\n      <button @click=\"goback\">返回登录界面</button>\r\n      <div>{{ station.id }}   {{ station.name }} 充电桩信息</div>\r\n      <el-table :data=\"charge_array\" style=\"width:100%\" :cell-style=\"{ textAlign: 'center' }\">\r\n      <el-table-column prop=\"id\" label=\"ID\" width=\"150\">\r\n        <template slot-scope=\"scope\">\r\n          <div @click=\"jump(scope.row.id)\">\r\n            {{ scope.row.id }}\r\n          </div>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"name\" label=\"姓名\" width=\"150\"> </el-table-column>\r\n      <el-table-column prop=\"mode\" label=\"模式\" width=\"150\"> </el-table-column>\r\n      <el-table-column prop=\"price\" label=\"单价\" width=\"150\"> </el-table-column>\r\n      <!-- 加按钮进行开关 -->\r\n      <el-table-column prop=\"state\" label=\"状态\" width=\"150\"> \r\n        <template slot-scope=\"scope\">\r\n          <el-button @click=\"changestate(scope.$index)\">\r\n            {{ scope.row.state ? \"开启(点击关机)\" : \"关机(点击开机)\" }}\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"total_charge\" label=\"总充电总量\" width=\"150\"> </el-table-column>\r\n      <el-table-column prop=\"total_charge_times\" label=\"总充电次数\r\n\" width=\"150\"> </el-table-column>\r\n      <el-table-column prop=\"total_charge_duration\" label=\"总充电时长\" width=\"150\"> </el-table-column>\r\n      <el-table-column prop=\"\" label=\"车辆信息\" width=\"150\"> \r\n        <template slot-scope=\"scope\">\r\n          <el-button @click=\"jumpcharge(scope.row.id)\">\r\n            查看充电等候区车辆信息\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <div>等候区车辆信息</div>\r\n    <el-table :data=\"wait_array\" style=\"width:100%\" :cell-style=\"{ textAlign: 'center' }\">\r\n      <el-table-column prop=\"user_id\" label=\"用户\" width=\"150\"></el-table-column>\r\n      <el-table-column prop=\"name\" label=\"名字\" width=\"150\"></el-table-column>\r\n      <el-table-column prop=\"power_capicity\" label=\"电池总容量\" width=\"150\"></el-table-column>\r\n      <el-table-column prop=\"power_current\" label=\"当前电量\" width=\"150\"></el-table-column>\r\n      <el-table-column prop=\"state\" label=\"当前状态\" width=\"150\"></el-table-column>\r\n    </el-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport report from \"./report.vue\"\r\n    export default {\r\n        name:'manage',\r\n        data(){\r\n          return{\r\n            station:{},\r\n            charge_array:[],\r\n            wait_array:[]\r\n          }\r\n        },\r\n        // mounted(){\r\n        //   this.autogetdata();\r\n        //   this.timer = setInterval(this.autogetdata,30000)\r\n        // },\r\n        methods:{\r\n          autogetdata(){\r\n            var token = localStorage.getItem('token')\r\n            var send_data={\r\n              \"token\":'1',\r\n              \"query_info\": {\r\n                \"msg\": \"\"\r\n              }\r\n            }\r\n            console.log(\"获取数据\")\r\n            console.log(\"我被执行了\")\r\n            this.axios({\r\n              method:'GET',\r\n              url:`https://mock.apifox.cn/m1/2726825-0-default/admin/index/manage`,\r\n              // headers:{\r\n              //   'Content-type': 'application/json; charset=UTF-8'\r\n              // },\r\n              data:JSON.stringify(send_data)\r\n            })\r\n            .then((response)=>{\r\n              console.log(\"@autogetdata\")\r\n              console.log(response)\r\n              if(response.data.code != 0){\r\n                this.station = response.data.data.station\r\n                this.charge_array = response.data.data.station.charge_array\r\n                this.wait_array = response.data.data.station.wait_array\r\n                console.log(this.charge_array)\r\n              }\r\n              else{\r\n                this.info = response.data.msg\r\n              }\r\n            })\r\n            .catch((error) => {\r\n              alert('manage出错了')\r\n              // this.$router.push('/admin/manage')\r\n            })\r\n          },\r\n          jump(id){\r\n            // console.log(\"点击\"+id)\r\n            this.$router.replace({\r\n              path:'/admin/index/report',\r\n              query:{\r\n                \"stationid\":id,\r\n              }\r\n            })\r\n          },\r\n          changestate(index){\r\n            var send_data = {\r\n              \"token\":localStorage.getItem(\"token\"),\r\n              \"switch_array\":[this.charge_array[index].id]\r\n            }\r\n            this.axios({\r\n            method:'POST',\r\n            url:`https://mock.apifox.cn/m1/2726825-0-default/admin/index/manage`,\r\n            headers:{\r\n              'Content-type': 'application/json; charset=UTF-8'\r\n            },\r\n            data:JSON.stringify(send_data)\r\n          })\r\n          .then((response)=>{\r\n            console.log(\"@changestate\"+response)\r\n            if(response.data.code != 0){\r\n              // console.log(response)\r\n              // this.$router.push('/admin/manage')\r\n              this.charge_array[index].state = !this.charge_array[index].state\r\n            }\r\n            else{\r\n              this.info = response.data.msg\r\n            }\r\n          })\r\n          .catch((error) => {\r\n            alert('出错了')\r\n            // this.$router.push('/admin/manage')\r\n          })\r\n            \r\n          },\r\n          jumpcharge(id){\r\n            this.$router.replace({\r\n              path:'/admin/manage/charge',\r\n              query:{\r\n                \"stationid\":id\r\n              }\r\n            })\r\n          },\r\n          goback(){\r\n            this.$router.go(-1)\r\n          }\r\n        },\r\n        beforeDestroy(){\r\n          clearInterval(this.timer)\r\n          this.timer = null\r\n        },\r\n        beforeRouteLeave(to,from,next){\r\n          console.log(\"离开当前页面\")\r\n          clearInterval(this.timer)\r\n          next()\r\n          // this.timer = null\r\n        },\r\n        beforeRouteEnter(to,from,next){\r\n          next(vm => {\r\n            console.log(\"enter\")\r\n            vm.autogetdata();\r\n            vm.timer = setInterval(vm.autogetdata,30000)\r\n          })\r\n          \r\n        }\r\n    }\r\n</script>\r\n\r\n<style>\r\n\r\n</style>"],"mappings":"AA+CA,OAAAA,MAAA;AACA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,OAAA;MACAC,YAAA;MACAC,UAAA;IACA;EACA;EACA;EACA;EACA;EACA;EACAC,OAAA;IACAC,YAAA;MACA,IAAAC,KAAA,GAAAC,YAAA,CAAAC,OAAA;MACA,IAAAC,SAAA;QACA;QACA;UACA;QACA;MACA;MACAC,OAAA,CAAAC,GAAA;MACAD,OAAA,CAAAC,GAAA;MACA,KAAAC,KAAA;QACAC,MAAA;QACAC,GAAA;QACA;QACA;QACA;QACAd,IAAA,EAAAe,IAAA,CAAAC,SAAA,CAAAP,SAAA;MACA,GACAQ,IAAA,CAAAC,QAAA;QACAR,OAAA,CAAAC,GAAA;QACAD,OAAA,CAAAC,GAAA,CAAAO,QAAA;QACA,IAAAA,QAAA,CAAAlB,IAAA,CAAAmB,IAAA;UACA,KAAAlB,OAAA,GAAAiB,QAAA,CAAAlB,IAAA,CAAAA,IAAA,CAAAC,OAAA;UACA,KAAAC,YAAA,GAAAgB,QAAA,CAAAlB,IAAA,CAAAA,IAAA,CAAAC,OAAA,CAAAC,YAAA;UACA,KAAAC,UAAA,GAAAe,QAAA,CAAAlB,IAAA,CAAAA,IAAA,CAAAC,OAAA,CAAAE,UAAA;UACAO,OAAA,CAAAC,GAAA,MAAAT,YAAA;QACA,OACA;UACA,KAAAkB,IAAA,GAAAF,QAAA,CAAAlB,IAAA,CAAAqB,GAAA;QACA;MACA,GACAC,KAAA,CAAAC,KAAA;QACAC,KAAA;QACA;MACA;IACA;;IACAC,KAAAC,EAAA;MACA;MACA,KAAAC,OAAA,CAAAC,OAAA;QACAC,IAAA;QACAC,KAAA;UACA,aAAAJ;QACA;MACA;IACA;IACAK,YAAAC,KAAA;MACA,IAAAvB,SAAA;QACA,SAAAF,YAAA,CAAAC,OAAA;QACA,sBAAAN,YAAA,CAAA8B,KAAA,EAAAN,EAAA;MACA;MACA,KAAAd,KAAA;QACAC,MAAA;QACAC,GAAA;QACAmB,OAAA;UACA;QACA;QACAjC,IAAA,EAAAe,IAAA,CAAAC,SAAA,CAAAP,SAAA;MACA,GACAQ,IAAA,CAAAC,QAAA;QACAR,OAAA,CAAAC,GAAA,kBAAAO,QAAA;QACA,IAAAA,QAAA,CAAAlB,IAAA,CAAAmB,IAAA;UACA;UACA;UACA,KAAAjB,YAAA,CAAA8B,KAAA,EAAAE,KAAA,SAAAhC,YAAA,CAAA8B,KAAA,EAAAE,KAAA;QACA,OACA;UACA,KAAAd,IAAA,GAAAF,QAAA,CAAAlB,IAAA,CAAAqB,GAAA;QACA;MACA,GACAC,KAAA,CAAAC,KAAA;QACAC,KAAA;QACA;MACA;IAEA;;IACAW,WAAAT,EAAA;MACA,KAAAC,OAAA,CAAAC,OAAA;QACAC,IAAA;QACAC,KAAA;UACA,aAAAJ;QACA;MACA;IACA;IACAU,OAAA;MACA,KAAAT,OAAA,CAAAU,EAAA;IACA;EACA;EACAC,cAAA;IACAC,aAAA,MAAAC,KAAA;IACA,KAAAA,KAAA;EACA;EACAC,iBAAAC,EAAA,EAAAC,IAAA,EAAAC,IAAA;IACAlC,OAAA,CAAAC,GAAA;IACA4B,aAAA,MAAAC,KAAA;IACAI,IAAA;IACA;EACA;;EACAC,iBAAAH,EAAA,EAAAC,IAAA,EAAAC,IAAA;IACAA,IAAA,CAAAE,EAAA;MACApC,OAAA,CAAAC,GAAA;MACAmC,EAAA,CAAAzC,WAAA;MACAyC,EAAA,CAAAN,KAAA,GAAAO,WAAA,CAAAD,EAAA,CAAAzC,WAAA;IACA;EAEA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}